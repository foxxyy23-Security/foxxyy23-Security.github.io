<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SentinelOne API Notes | Bryan Fox</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        /* Specific styles for code blocks in notes */
        pre {
            background-color: #0d1117;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            border: 1px solid #30363d;
            color: #c9d1d9;
            font-family: 'Courier New', Courier, monospace;
            margin-bottom: 1.5rem;
        }
        code {
            color: var(--accent-secondary);
        }
        .note-section {
            margin-bottom: 3rem;
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="../index.html" class="nav-logo">foxxyy23</a>
            <div class="nav-links">
                <a href="../index.html" class="nav-link">Home</a>
                <a href="../notebook.html" class="nav-link active">Notebook</a>
                <a href="../blog.html" class="nav-link">Blog</a>
            </div>
        </div>
    </nav>

    <main class="container">
        
        <article style="max-width: 800px; margin: 0 auto; padding-top: 2rem;">
            <h1 style="font-size: 2rem; margin-bottom: 0.5rem; color: var(--accent-primary);">SentinelOne API Quick Start</h1>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">Common endpoints and Python snippets for automation.</p>
            
            <div class="note-section">
                <h3>Authentication</h3>
                <p>Headers required for all requests.</p>
                <pre>
headers = {
    "Authorization": "ApiToken &lt;YOUR_API_TOKEN&gt;",
    "Content-Type": "application/json"
}
base_url = "https://usea1-001.sentinelone.net/web/api/v2.1"</pre>
            </div>

            <div class="note-section">
                <h3>Get Agent Info</h3>
                <p>Retrieve details for a specific endpoint by hostname.</p>
                <pre>
def get_agent_id(hostname):
    params = {
        "computerName": hostname,
        "isActive": True
    }
    response = requests.get(f"{base_url}/agents", headers=headers, params=params)
    return response.json()['data'][0]['id']</pre>
            </div>

            <div class="note-section">
                <h3>Isolate Endpoint</h3>
                <p><strong>Warning:</strong> This disconnects the host from the network.</p>
                <pre>
def isolate_host(agent_id):
    payload = {
        "filter": {
            "ids": [agent_id]
        }
    }
    response = requests.post(f"{base_url}/agents/actions/disconnect", headers=headers, json=payload)
    return response.status_code</pre>
            </div>

            <div class="note-section">
                <h3>Fetch Threat Notes</h3>
                <p>Get analyst notes attached to a specific threat ID.</p>
                <pre>
GET /threats/{threat_id}/notes
# Useful for syncing S1 notes to Jira/ServiceNow</pre>
            </div>

            <div style="margin-top: 4rem; border-top: 1px solid var(--card-bg); padding-top: 2rem; text-align: center;">
                <a href="../notebook.html" class="btn btn-outline">‚Üê Back to Notebook</a>
            </div>
        </article>

    </main>

</body>
</html>
